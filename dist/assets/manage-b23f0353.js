import{a4 as ce,c as D,f as R,o as re,S as _,U as p,V as C,W as t,k as s,X as i,u as v,Z as o,G as n,m as ue,A as pe,_ as k,a0 as f,F as me,Y as _e,a6 as ve}from"./vendor-e4b530e5.js";import{_ as fe}from"./index-053c0381.js";import{K as ge,F as be,E as V,r as ye,v as Ce,f as ke,z as je,Q as we,V as xe,H as Re,b as he,m as h,W as Te,$ as Ie,J as $e}from"./antd-19bac614.js";const ze={class:"applicant-manage-container"},Ne={class:"page-header"},Oe={class:"header-actions"},Se={class:"stats-overview"},Pe={class:"stats-flex-container"},Me={class:"stat-icon"},qe={class:"stat-content"},Ue={class:"stat-number"},Fe={class:"stat-icon"},De={class:"stat-content"},Ve={class:"stat-number"},Je={class:"stat-icon"},Be={class:"stat-content"},Ae={class:"stat-number"},Ee={class:"stat-icon"},Qe={class:"stat-content"},We={class:"stat-number"},Ge={class:"stat-icon"},He={class:"stat-content"},Ke={class:"stat-number"},Le={class:"stat-icon"},Xe={class:"stat-content"},Ye={class:"stat-number"},Ze={class:"stat-icon"},et={class:"stat-content"},tt={class:"stat-number"},st={class:"flow-content"},at={class:"step-description"},it={class:"step-status-tags"},nt={class:"step-description"},lt={class:"step-status-tags"},ot={class:"step-description"},dt={class:"step-status-tags"},ct={class:"card-title-with-total"},rt={class:"header-filters"},ut={key:0,class:"project-info"},pt={class:"project-name"},mt={class:"project-code"},_t={key:2,class:"progress-info"},vt={class:"progress-text"},ft={key:0,class:"detail-modal"},gt={class:"detail-section"},bt={key:0,class:"detail-section"},yt={class:"materials-list"},Ct={class:"material-info"},kt={class:"material-name"},jt={class:"material-type"},wt={key:1,class:"detail-section"},xt={class:"requirements-text"},Rt={key:2,class:"detail-section"},ht={class:"rejection-reason"},Tt={__name:"manage",setup(It){const T=ce(),j=D(()=>{const a=y.value.length,e=y.value.filter(c=>c.status==="material_reviewing").length,u=y.value.filter(c=>c.status==="material_rejected").length,x=y.value.filter(c=>c.status==="meeting_preparing").length,b=y.value.filter(c=>c.status==="meeting_scheduled").length,O=y.value.filter(c=>c.status==="acceptance_passed").length,z=y.value.filter(c=>c.status==="acceptance_conditional").length,S=y.value.filter(c=>c.status==="acceptance_failed").length;return{total:a,materialReviewing:e,materialRejected:u,meetingPreparing:x,meetingScheduled:b,acceptancePassed:O,acceptanceConditional:z,acceptanceFailed:S}}),g=R({status:"",keyword:""}),I=R(!1),$=R(!1),l=R(null),y=R([{id:1,projectName:"智慧城市大数据平台建设项目",projectCode:"PROJ-2024-001",status:"material_reviewing",submitTime:"2024-01-15",expectedTime:"2024-03-15",description:"构建城市级大数据分析平台，支持多源数据接入和实时分析",materials:[{id:1,name:"项目验收报告.pdf",type:"验收报告"},{id:2,name:"技术文档.docx",type:"技术文档"}],materialRejected:!0,rejectionInfo:{time:"2024-01-18",reviewer:"张审核员",comments:"材料基本符合要求，但需要完善部分内容。",rejectionReason:"1. 项目验收报告中缺少详细的测试数据和性能指标；2. 技术文档需要补充系统架构图和数据库设计说明；3. 请提供用户手册和部署指南。"}},{id:2,projectName:"区块链供应链金融平台",projectCode:"PROJ-2024-002",status:"meeting_preparing",submitTime:"2024-01-20",expectedTime:"2024-03-20",description:"基于区块链技术的供应链金融解决方案",materials:[{id:3,name:"项目验收报告.pdf",type:"验收报告"}]},{id:3,projectName:"物联网环境监测系统",projectCode:"PROJ-2024-003",status:"meeting_scheduled",submitTime:"2024-01-12",expectedTime:"2024-03-12",description:"部署IoT传感器网络，实现环境数据实时监控",materials:[{id:4,name:"项目验收报告.pdf",type:"验收报告"},{id:5,name:"系统部署文档.pdf",type:"部署文档"}]},{id:4,projectName:"电子商务数据分析系统",projectCode:"PROJ-2024-004",status:"acceptance_passed",submitTime:"2024-01-08",expectedTime:"2024-03-08",description:"数据分析系统开发完成，功能完善",materials:[{id:6,name:"项目验收报告.pdf",type:"验收报告"}],finalResult:{conclusion:"passed",score:92,time:"2024-01-22",description:"项目验收通过，系统功能完整，技术指标达标。"}},{id:5,projectName:"在线教育管理平台",projectCode:"PROJ-2024-005",status:"acceptance_conditional",submitTime:"2024-01-03",expectedTime:"2024-03-03",description:"在线教育平台核心功能已完成，正在完善细节功能",materials:[{id:7,name:"项目验收报告.pdf",type:"验收报告"},{id:8,name:"用户操作手册.pdf",type:"用户手册"}],finalResult:{conclusion:"conditional_passed",score:82,time:"2024-01-21",description:"项目基本达到验收要求，有条件通过验收。",requirements:"1. 完善数据备份机制；2. 优化系统界面布局；3. 30天内提交整改确认。"}},{id:6,projectName:"移动办公应用系统",projectCode:"PROJ-2024-006",status:"acceptance_failed",submitTime:"2024-01-05",expectedTime:"2024-03-05",description:"移动办公系统基本完成，部分功能待完善",materials:[{id:9,name:"项目验收报告.pdf",type:"验收报告"}],finalResult:{conclusion:"failed",score:68,time:"2024-01-20",description:"项目验收未通过，系统稳定性有待提升，需要完善相关功能。",requirements:"1. 优化系统性能；2. 完善用户界面；3. 补充测试文档。"}}]),J=[{title:"项目信息",key:"projectInfo",width:300},{title:"申请状态",key:"status",width:120},{title:"提交时间",dataIndex:"submitTime",width:120},{title:"预期验收时间",dataIndex:"expectedTime",width:140},{title:"验收进度",key:"progress",width:200},{title:"操作",key:"actions",width:200,fixed:"right"}],M=R({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:a=>`共 ${a} 条记录`}),B=D(()=>{let a=y.value;return g.value.status&&(a=a.filter(e=>e.status===g.value.status)),g.value.keyword&&(a=a.filter(e=>e.projectName.includes(g.value.keyword)||e.projectCode.includes(g.value.keyword))),M.value.total=a.length,a}),q=a=>({material_reviewing:"orange",meeting_preparing:"blue",meeting_scheduled:"cyan",acceptance_passed:"green",acceptance_conditional:"orange",acceptance_failed:"red"})[a]||"default",U=a=>({material_reviewing:"材料审核中",meeting_preparing:"会议待组织",meeting_scheduled:"会议已安排",acceptance_passed:"验收通过",acceptance_conditional:"有条件通过",acceptance_failed:"验收未通过"})[a]||"未知",A=a=>({material_reviewing:35,meeting_preparing:60,meeting_scheduled:80,acceptance_passed:100,acceptance_conditional:95,acceptance_failed:100})[a]||0,E=a=>a==="acceptance_failed"?"exception":a==="acceptance_passed"?"success":"active",Q=(a,e=null)=>a==="material_reviewing"&&(e!=null&&e.materialRejected)?"材料需要重新提交":{material_reviewing:"材料审核中",meeting_preparing:"会议待组织",meeting_scheduled:"等待参加会议",acceptance_passed:"验收通过",acceptance_conditional:"待提交整改材料",acceptance_failed:"验收未通过"}[a]||"未知阶段",W=()=>{T.push("/th_qd/acceptance/applicant/submit")},G=()=>{},H=()=>{},K=a=>{h.info(`重新提交申请：${a.projectName}`);let e="";a.reviewComments&&a.reviewComments.length>0&&(e=a.reviewComments.map(u=>`【${u.reviewer} - ${u.time}】：${u.content}`).join(`
`)),T.push({path:"/acceptance/application/submit",query:{resubmit:"true",projectId:a.id,projectName:encodeURIComponent(a.projectName),projectCode:a.projectCode,expectedTime:a.expectedTime,description:encodeURIComponent(a.description),reviewComments:encodeURIComponent(e)}})},L=a=>{l.value=a,$.value=!0},X=()=>{$.value=!1,l.value=null},Y=a=>{h.info(`预览材料：${a.name}`)},Z=a=>{h.success(`下载材料：${a.name}`)},ee=a=>{var e;T.push({path:"/acceptance/application/submit",query:{resubmit:"true",projectId:a.id,projectName:encodeURIComponent(a.projectName),projectCode:a.projectCode,expectedTime:a.expectedTime,description:encodeURIComponent(a.description),rejectionReason:encodeURIComponent(((e=a.rejectionInfo)==null?void 0:e.rejectionReason)||"")}})},te=a=>{const e=a.rejectionInfo;if(!e){h.warning("暂无驳回信息");return}const u=`
    <div style="line-height: 1.6;">
      <div style="margin-bottom: 16px;">
        <strong>驳回时间：</strong>${e.time}
      </div>
      <div style="margin-bottom: 16px;">
        <strong>审核人员：</strong>${e.reviewer}
      </div>
      <div style="margin-bottom: 16px;">
        <strong>审核意见：</strong>
        <div style="margin-top: 8px; padding: 12px; background: #f5f5f5; border-radius: 6px;">
          ${e.comments}
        </div>
      </div>
      <div style="margin-bottom: 16px;">
        <strong>具体要求：</strong>
        <div style="margin-top: 8px; padding: 12px; background: #fff2f0; border: 1px solid #ffccc7; border-radius: 6px; white-space: pre-line;">
          ${e.rejectionReason}
        </div>
      </div>
      <div style="margin-top: 16px; padding: 12px; background: #e6f7ff; border-radius: 6px;">
        <div style="color: #1890ff; font-weight: 500;">💡 温馨提示</div>
        <div style="margin-top: 4px; color: #666;">请根据上述要求修改和补充材料后重新提交，如有疑问可联系审核人员。</div>
      </div>
    </div>
  `;Te.info({title:"材料审核驳回详情",width:600,content:u,okText:"我知道了"})},se=a=>{h.info(`提交整改材料：${a.projectName}`);let e="";a.finalResult&&a.finalResult.requirements&&(e=a.finalResult.requirements),T.push({path:"/acceptance/application/submit",query:{improvement:"true",projectId:a.id,projectName:encodeURIComponent(a.projectName),projectCode:a.projectCode,expectedTime:a.expectedTime,description:encodeURIComponent(a.description),improvementRequirements:encodeURIComponent(e)}})},ae=()=>{I.value=!I.value},w=a=>{g.value.keyword="",g.value.status=a};return re(()=>{}),(a,e)=>{const u=_("a-button"),x=_("a-step"),b=_("a-tag"),O=_("a-steps"),z=_("a-card"),S=_("a-badge"),c=_("a-select-option"),ie=_("a-select"),ne=_("a-input-search"),le=_("a-progress"),F=_("a-space"),oe=_("a-table"),m=_("a-descriptions-item"),P=_("a-descriptions"),de=_("a-modal");return p(),C("div",ze,[t("div",Ne,[e[11]||(e[11]=t("div",{class:"header-content"},[t("h1",{class:"page-title"},"验收申请管理"),t("p",{class:"page-description"},"查看和管理您提交的项目验收申请")],-1)),t("div",Oe,[s(u,{type:"primary",onClick:W},{default:i(()=>[s(v(ge)),e[10]||(e[10]=n(" 提交新申请 ",-1))]),_:1,__:[10]})])]),t("div",Se,[t("div",Pe,[t("div",{class:"stat-card pending",onClick:e[0]||(e[0]=d=>w("material_reviewing"))},[t("div",Me,[s(v(be))]),t("div",qe,[t("div",Ue,o(j.value.materialReviewing),1),e[12]||(e[12]=t("div",{class:"stat-label"},"材料审核中",-1))])]),t("div",{class:"stat-card material-rejected",onClick:e[1]||(e[1]=d=>w("material_rejected"))},[t("div",Fe,[s(v(V))]),t("div",De,[t("div",Ve,o(j.value.materialRejected),1),e[13]||(e[13]=t("div",{class:"stat-label"},"材料审核未通过",-1))])]),t("div",{class:"stat-card reviewing",onClick:e[2]||(e[2]=d=>w("meeting_preparing"))},[t("div",Je,[s(v(ye))]),t("div",Be,[t("div",Ae,o(j.value.meetingPreparing),1),e[14]||(e[14]=t("div",{class:"stat-label"},"会议待组织",-1))])]),t("div",{class:"stat-card scheduled",onClick:e[3]||(e[3]=d=>w("meeting_scheduled"))},[t("div",Ee,[s(v(Ce))]),t("div",Qe,[t("div",We,o(j.value.meetingScheduled),1),e[15]||(e[15]=t("div",{class:"stat-label"},"会议已安排",-1))])]),t("div",{class:"stat-card completed",onClick:e[4]||(e[4]=d=>w("acceptance_passed"))},[t("div",Ge,[s(v(ke))]),t("div",He,[t("div",Ke,o(j.value.acceptancePassed),1),e[16]||(e[16]=t("div",{class:"stat-label"},"验收通过",-1))])]),t("div",{class:"stat-card conditional",onClick:e[5]||(e[5]=d=>w("acceptance_conditional"))},[t("div",Le,[s(v(je))]),t("div",Xe,[t("div",Ye,o(j.value.acceptanceConditional),1),e[17]||(e[17]=t("div",{class:"stat-label"},"有条件通过",-1))])]),t("div",{class:"stat-card rejected",onClick:e[6]||(e[6]=d=>w("acceptance_failed"))},[t("div",Ze,[s(v(we))]),t("div",et,[t("div",tt,o(j.value.acceptanceFailed),1),e[18]||(e[18]=t("div",{class:"stat-label"},"验收未通过",-1))])])])]),s(z,{class:"flow-description",title:"验收流程说明",bordered:!1},{extra:i(()=>[s(u,{type:"link",size:"small",onClick:ae},{default:i(()=>[n(o(I.value?"收起":"展开"),1)]),_:1})]),default:i(()=>[ue(t("div",st,[s(O,{current:3,size:"small",direction:"horizontal",status:"finish"},{default:i(()=>[s(x,{title:"提交申请",description:"准备材料并提交验收申请",status:"finish"}),s(x,{title:"材料审核",status:"finish"},{description:i(()=>[t("div",at,[e[20]||(e[20]=n(" 等待管理员审核验收材料 ",-1)),t("div",it,[s(b,{color:"orange",size:"small"},{default:i(()=>e[19]||(e[19]=[n("材料审核中",-1)])),_:1,__:[19]})])])]),_:1}),s(x,{title:"组织会议",status:"finish"},{description:i(()=>[t("div",nt,[e[23]||(e[23]=n(" 等待管理员组织验收会议 ",-1)),t("div",lt,[s(b,{color:"blue",size:"small"},{default:i(()=>e[21]||(e[21]=[n("会议待组织",-1)])),_:1,__:[21]}),s(b,{color:"cyan",size:"small"},{default:i(()=>e[22]||(e[22]=[n("会议已安排",-1)])),_:1,__:[22]})])])]),_:1}),s(x,{title:"验收结论",status:"finish"},{description:i(()=>[t("div",ot,[e[27]||(e[27]=n(" 根据会议结果获得最终结论 ",-1)),t("div",dt,[s(b,{color:"green",size:"small"},{default:i(()=>e[24]||(e[24]=[n("验收通过",-1)])),_:1,__:[24]}),s(b,{color:"orange",size:"small"},{default:i(()=>e[25]||(e[25]=[n("有条件通过",-1)])),_:1,__:[25]}),s(b,{color:"red",size:"small"},{default:i(()=>e[26]||(e[26]=[n("验收未通过",-1)])),_:1,__:[26]})])])]),_:1})]),_:1})],512),[[pe,I.value]])]),_:1}),s(z,{bordered:!1},{title:i(()=>[t("div",ct,[e[28]||(e[28]=t("span",null,"我的验收申请",-1)),s(S,{count:j.value.total,"number-style":{backgroundColor:"#1890ff"}},null,8,["count"])])]),extra:i(()=>[t("div",rt,[s(ie,{value:g.value.status,"onUpdate:value":e[7]||(e[7]=d=>g.value.status=d),placeholder:"筛选状态",style:{width:"150px"},onChange:G},{default:i(()=>[s(c,{value:""},{default:i(()=>e[29]||(e[29]=[n("全部状态",-1)])),_:1,__:[29]}),s(c,{value:"material_reviewing"},{default:i(()=>e[30]||(e[30]=[n("材料审核中",-1)])),_:1,__:[30]}),s(c,{value:"meeting_preparing"},{default:i(()=>e[31]||(e[31]=[n("会议待组织",-1)])),_:1,__:[31]}),s(c,{value:"meeting_scheduled"},{default:i(()=>e[32]||(e[32]=[n("会议已安排",-1)])),_:1,__:[32]}),s(c,{value:"acceptance_passed"},{default:i(()=>e[33]||(e[33]=[n("验收通过",-1)])),_:1,__:[33]}),s(c,{value:"acceptance_conditional"},{default:i(()=>e[34]||(e[34]=[n("有条件通过",-1)])),_:1,__:[34]}),s(c,{value:"acceptance_failed"},{default:i(()=>e[35]||(e[35]=[n("验收未通过",-1)])),_:1,__:[35]})]),_:1},8,["value"]),s(ne,{value:g.value.keyword,"onUpdate:value":e[8]||(e[8]=d=>g.value.keyword=d),placeholder:"搜索项目名称",style:{width:"200px"},onSearch:H},null,8,["value"])])]),default:i(()=>[s(oe,{columns:J,"data-source":B.value,pagination:M.value,"row-key":"id",size:"middle"},{bodyCell:i(({column:d,record:r})=>[d.key==="projectInfo"?(p(),C("div",ut,[t("div",pt,o(r.projectName),1),t("div",mt,o(r.projectCode),1)])):d.key==="status"?(p(),k(b,{key:1,color:q(r.status)},{default:i(()=>[n(o(U(r.status)),1)]),_:2},1032,["color"])):d.key==="progress"?(p(),C("div",_t,[s(le,{percent:A(r.status),size:"small",status:E(r.status)},null,8,["percent","status"]),t("div",vt,o(Q(r.status,r)),1)])):d.key==="actions"?(p(),k(F,{key:3},{default:i(()=>[r.status==="material_rejected"?(p(),k(u,{key:0,type:"primary",size:"small",onClick:N=>ee(r)},{default:i(()=>e[36]||(e[36]=[n(" 重新提交材料 ",-1)])),_:2,__:[36]},1032,["onClick"])):f("",!0),r.status==="acceptance_conditional"?(p(),k(u,{key:1,type:"primary",size:"small",onClick:N=>se(r)},{default:i(()=>e[37]||(e[37]=[n(" 提交整改材料 ",-1)])),_:2,__:[37]},1032,["onClick"])):f("",!0),r.status==="acceptance_failed"?(p(),k(u,{key:2,type:"primary",size:"small",onClick:N=>K(r)},{default:i(()=>e[38]||(e[38]=[n(" 重新提交申请 ",-1)])),_:2,__:[38]},1032,["onClick"])):f("",!0),r.status==="material_rejected"?(p(),k(u,{key:3,size:"small",onClick:N=>te(r)},{default:i(()=>e[39]||(e[39]=[n(" 查看驳回原因 ",-1)])),_:2,__:[39]},1032,["onClick"])):f("",!0),["acceptance_passed","acceptance_conditional","acceptance_failed"].includes(r.status)?(p(),k(u,{key:4,size:"small",onClick:N=>L(r)},{default:i(()=>e[40]||(e[40]=[n(" 查看详情 ",-1)])),_:2,__:[40]},1032,["onClick"])):f("",!0)]),_:2},1024)):f("",!0)]),_:1},8,["data-source","pagination"])]),_:1}),s(de,{open:$.value,"onUpdate:open":e[9]||(e[9]=d=>$.value=d),title:"验收申请详情",width:"800px",footer:null,onCancel:X},{default:i(()=>[l.value?(p(),C("div",ft,[t("div",gt,[t("h4",null,[s(v(xe)),e[41]||(e[41]=n(" 项目基本信息",-1))]),s(P,{column:2,bordered:"",size:"small"},{default:i(()=>[s(m,{label:"项目编号"},{default:i(()=>[n(o(l.value.projectCode),1)]),_:1}),s(m,{label:"项目名称",span:2},{default:i(()=>[n(o(l.value.projectName),1)]),_:1}),s(m,{label:"申请时间"},{default:i(()=>[n(o(l.value.submitTime),1)]),_:1}),s(m,{label:"预期验收时间"},{default:i(()=>[n(o(l.value.expectedTime),1)]),_:1}),s(m,{label:"当前状态"},{default:i(()=>[s(b,{color:q(l.value.status)},{default:i(()=>[n(o(U(l.value.status)),1)]),_:1},8,["color"])]),_:1}),s(m,{label:"项目描述",span:2},{default:i(()=>[n(o(l.value.description),1)]),_:1})]),_:1})]),l.value.materials&&l.value.materials.length>0?(p(),C("div",bt,[t("h4",null,[s(v(Re)),e[42]||(e[42]=n(" 提交材料",-1))]),t("div",yt,[(p(!0),C(me,null,_e(l.value.materials,d=>(p(),C("div",{class:"material-item",key:d.id},[t("div",Ct,[t("div",kt,o(d.name),1),t("div",jt,o(d.type),1)]),s(F,null,{default:i(()=>[s(u,{size:"small",type:"text",onClick:r=>Y(d)},{default:i(()=>[s(v(Ie)),e[43]||(e[43]=n(" 预览 ",-1))]),_:2,__:[43]},1032,["onClick"]),s(u,{size:"small",type:"text",onClick:r=>Z(d)},{default:i(()=>[s(v($e)),e[44]||(e[44]=n(" 下载 ",-1))]),_:2,__:[44]},1032,["onClick"])]),_:2},1024)]))),128))])])):f("",!0),l.value.finalResult?(p(),C("div",wt,[t("h4",null,[s(v(he)),e[45]||(e[45]=n(" 验收结论",-1))]),s(P,{column:2,bordered:"",size:"small"},{default:i(()=>[s(m,{label:"验收结果"},{default:i(()=>[s(b,{color:l.value.finalResult.conclusion==="passed"?"green":l.value.finalResult.conclusion==="failed"?"red":"orange"},{default:i(()=>[n(o(l.value.finalResult.conclusion==="passed"?"验收通过":l.value.finalResult.conclusion==="failed"?"验收未通过":"有条件通过"),1)]),_:1},8,["color"])]),_:1}),s(m,{label:"结论时间"},{default:i(()=>[n(o(l.value.finalResult.time),1)]),_:1}),l.value.finalResult.score?(p(),k(m,{key:0,label:"评分"},{default:i(()=>[t("span",{style:ve({color:l.value.finalResult.score>=90?"#52c41a":l.value.finalResult.score>=80?"#fa8c16":"#ff4d4f"})},o(l.value.finalResult.score)+"分 ",5)]),_:1})):f("",!0),s(m,{label:"结论说明",span:2},{default:i(()=>[n(o(l.value.finalResult.description),1)]),_:1}),l.value.finalResult.requirements?(p(),k(m,{key:1,label:"整改要求",span:2},{default:i(()=>[t("div",xt,o(l.value.finalResult.requirements),1)]),_:1})):f("",!0)]),_:1})])):f("",!0),l.value.rejectionInfo?(p(),C("div",Rt,[t("h4",null,[s(v(V)),e[46]||(e[46]=n(" 驳回信息",-1))]),s(P,{column:2,bordered:"",size:"small"},{default:i(()=>[s(m,{label:"驳回时间"},{default:i(()=>[n(o(l.value.rejectionInfo.time),1)]),_:1}),s(m,{label:"审核人员"},{default:i(()=>[n(o(l.value.rejectionInfo.reviewer),1)]),_:1}),s(m,{label:"审核意见",span:2},{default:i(()=>[n(o(l.value.rejectionInfo.comments),1)]),_:1}),s(m,{label:"驳回原因",span:2},{default:i(()=>[t("div",ht,o(l.value.rejectionInfo.rejectionReason),1)]),_:1})]),_:1})])):f("",!0)])):f("",!0)]),_:1},8,["open"])])}}},Ot=fe(Tt,[["__scopeId","data-v-7ed9ec5b"]]);export{Ot as default};
