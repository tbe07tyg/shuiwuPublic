import{a4 as de,c as V,f as x,o as re,S as m,U as v,V as h,W as s,k as t,X as a,u as f,Z as o,G as l,m as pe,A as ue,_ as y,a0 as _,a6 as ce}from"./vendor-9e962977.js";import{_ as ve}from"./index-b9d63c8b.js";import{K as me,F as _e,E as F,r as D,v as fe,f as ge,z as be,Q as ye,V as Ce,b as ke,m as P,W as je}from"./antd-3abeaf7b.js";const we={class:"applicant-manage-container"},xe={class:"page-header"},he={class:"header-actions"},Ie={class:"stats-overview"},Re={class:"stats-flex-container"},Te={class:"stat-icon"},ze={class:"stat-content"},$e={class:"stat-number"},Ne={class:"stat-icon"},Se={class:"stat-content"},Oe={class:"stat-number"},Pe={class:"stat-icon"},qe={class:"stat-content"},Ue={class:"stat-number"},Me={class:"stat-icon"},Ve={class:"stat-content"},Fe={class:"stat-number"},De={class:"stat-icon"},Je={class:"stat-content"},Ae={class:"stat-number"},Be={class:"stat-icon"},Ee={class:"stat-content"},Qe={class:"stat-number"},We={class:"stat-icon"},Ge={class:"stat-content"},Ke={class:"stat-number"},Xe={class:"flow-content"},Ze={class:"step-description"},He={class:"step-status-tags"},Le={class:"step-description"},Ye={class:"step-status-tags"},et={class:"step-description"},tt={class:"step-status-tags"},at={class:"card-title-with-total"},st={class:"header-filters"},it={key:1,class:"progress-info"},lt={class:"progress-text"},nt={key:0,class:"detail-modal"},ot={class:"detail-section"},dt={key:0,class:"detail-section"},rt={key:1,class:"detail-section"},pt={class:"requirements-text"},ut={key:2,class:"detail-section"},ct={class:"rejection-reason"},vt={__name:"manage",setup(mt){const I=de(),k=V(()=>{const i=C.value.length,e=C.value.filter(r=>r.status==="material_reviewing").length,p=C.value.filter(r=>r.status==="material_rejected").length,w=C.value.filter(r=>r.status==="meeting_preparing").length,b=C.value.filter(r=>r.status==="meeting_scheduled").length,S=C.value.filter(r=>r.status==="approval_passed").length,z=C.value.filter(r=>r.status==="approval_conditional").length,O=C.value.filter(r=>r.status==="approval_failed").length;return{total:i,materialReviewing:e,materialRejected:p,meetingPreparing:w,meetingScheduled:b,approvalPassed:S,approvalConditional:z,approvalFailed:O}}),g=x({status:"",keyword:""}),R=x(!1),T=x(!1),n=x(null),C=x([{id:1,year:"2024",projectName:"智慧城市大数据平台建设项目",applicant:"王五",department:"技术部",duration:18,budget:200,submitTime:"2024-01-15",status:"material_reviewing",projectCode:"PROJ-2024-001",expectedTime:"2024-03-15",description:"构建城市级大数据分析平台，支持多源数据接入和实时分析",materialRejected:!0,rejectionInfo:{time:"2024-01-18",reviewer:"张审核员",comments:"材料基本符合要求，但需要完善部分内容。",rejectionReason:"1. 项目申请书中缺少详细的技术指标；2. 技术方案需要补充系统架构图；3. 请提供预算明细表。"}},{id:2,year:"2024",projectName:"区块链供应链金融平台",applicant:"赵六",department:"工程部",duration:12,budget:150,submitTime:"2024-01-20",status:"meeting_preparing",projectCode:"PROJ-2024-002",expectedTime:"2024-03-20",description:"基于区块链技术的供应链金融解决方案"},{id:3,year:"2024",projectName:"物联网环境监测系统",applicant:"李明",department:"自动化部",duration:24,budget:180,submitTime:"2024-01-12",status:"meeting_scheduled",projectCode:"PROJ-2024-003",expectedTime:"2024-03-12",description:"部署IoT传感器网络，实现环境数据实时监控",meetingInfo:{time:"2024-01-25 14:00",location:"会议室A301",type:"offline",description:"项目立项会议，重点评审环境监测系统的技术实现"}},{id:4,year:"2024",projectName:"电子商务数据分析系统",applicant:"王强",department:"信息部",duration:15,budget:220,submitTime:"2024-01-08",status:"approval_passed",projectCode:"PROJ-2024-004",expectedTime:"2024-03-08",description:"数据分析系统开发完成，功能完善",conclusion:{result:"passed",score:92,time:"2024-01-22",description:"项目立项通过，系统功能完整，技术指标达标。",feedback:"项目立项通过，技术方案可行，预算合理。"}},{id:5,year:"2024",projectName:"在线教育管理平台",applicant:"张华",department:"教育部",duration:20,budget:160,submitTime:"2024-01-03",status:"approval_conditional",projectCode:"PROJ-2024-005",expectedTime:"2024-03-03",description:"在线教育管理平台开发",conclusion:{result:"conditional_passed",score:82,time:"2024-01-21",description:"项目基本达到立项要求，有条件通过立项。",requirements:"1. 完善数据备份机制；2. 优化系统界面布局；3. 30天内提交整改确认。",feedback:"项目基本达到立项要求，有条件通过立项。需要在指定时间内完成整改要求。"},improvementSubmitted:!1},{id:6,year:"2024",projectName:"移动办公应用系统",applicant:"刘涛",department:"移动部",duration:14,budget:130,submitTime:"2024-01-05",status:"approval_failed",projectCode:"PROJ-2024-006",expectedTime:"2024-03-05",description:"移动办公应用系统开发",conclusion:{result:"failed",score:68,time:"2024-01-20",description:"项目立项未通过，系统稳定性有待提升，需要完善相关功能。",requirements:"1. 优化系统性能；2. 完善用户界面；3. 补充测试文档。",feedback:"项目立项未通过，系统稳定性有待提升，需要完善相关功能。建议重新修改方案后再次申请。"}}]),J=[{title:"年度",dataIndex:"year",width:80},{title:"立项名称",dataIndex:"projectName",width:220,ellipsis:!0},{title:"申请人",dataIndex:"applicant",width:100},{title:"申请单位",dataIndex:"department",width:140,ellipsis:!0},{title:"项目周期(月)",dataIndex:"duration",width:120},{title:"预算(万元)",dataIndex:"budget",width:110},{title:"申请时间",dataIndex:"submitTime",width:120},{title:"状态",key:"status",width:120},{title:"操作",key:"actions",width:160,fixed:"right"}],q=x({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:i=>`共 ${i} 条记录`}),A=V(()=>{let i=C.value;return g.value.status&&(i=i.filter(e=>e.status===g.value.status)),g.value.keyword&&(i=i.filter(e=>e.projectName.includes(g.value.keyword)||e.projectCode.includes(g.value.keyword))),q.value.total=i.length,i}),U=i=>({material_reviewing:"orange",meeting_preparing:"blue",meeting_scheduled:"cyan",approval_passed:"green",approval_conditional:"orange",approval_failed:"red"})[i]||"default",M=i=>({material_reviewing:"材料审核中",meeting_preparing:"会议待组织",meeting_scheduled:"会议已安排",approval_passed:"立项通过",approval_conditional:"有条件通过",approval_failed:"立项未通过"})[i]||"未知",B=i=>({material_reviewing:35,meeting_preparing:60,meeting_scheduled:80,approval_passed:100,approval_conditional:95,approval_failed:100})[i]||0,E=i=>i==="approval_failed"?"exception":i==="approval_passed"?"success":"active",Q=(i,e=null)=>i==="material_reviewing"&&(e!=null&&e.materialRejected)?"材料需要重新提交":{material_reviewing:"材料审核中",meeting_preparing:"会议待组织",meeting_scheduled:"等待参加会议",approval_passed:"立项通过",approval_conditional:"待提交整改材料",approval_failed:"立项未通过"}[i]||"未知阶段",W=()=>{I.push("/th_qd/approval/applicant/submit")},G=()=>{},K=()=>{},X=i=>{P.info(`重新提交申请：${i.projectName}`);let e="";i.reviewComments&&i.reviewComments.length>0&&(e=i.reviewComments.map(p=>`【${p.reviewer} - ${p.time}】：${p.content}`).join(`
`)),I.push({path:"/approval/applicant/submit",query:{resubmit:"true",projectId:i.id,projectName:encodeURIComponent(i.projectName),projectCode:i.projectCode,expectedTime:i.expectedTime,description:encodeURIComponent(i.description),reviewComments:encodeURIComponent(e)}})},Z=i=>{n.value=i,T.value=!0},H=()=>{T.value=!1,n.value=null},L=i=>{var e;I.push({path:"/approval/applicant/submit",query:{resubmit:"true",projectId:i.id,projectName:encodeURIComponent(i.projectName),projectCode:i.projectCode,expectedTime:i.expectedTime,description:encodeURIComponent(i.description),rejectionReason:encodeURIComponent(((e=i.rejectionInfo)==null?void 0:e.rejectionReason)||"")}})},Y=i=>{const e=i.rejectionInfo;if(!e){P.warning("暂无驳回信息");return}const p=`
    <div style="line-height: 1.6;">
      <div style="margin-bottom: 16px;">
        <strong>驳回时间：</strong>${e.time}
      </div>
      <div style="margin-bottom: 16px;">
        <strong>审核人员：</strong>${e.reviewer}
      </div>
      <div style="margin-bottom: 16px;">
        <strong>审核意见：</strong>
        <div style="margin-top: 8px; padding: 12px; background: #f5f5f5; border-radius: 6px;">
          ${e.comments}
        </div>
      </div>
      <div style="margin-bottom: 16px;">
        <strong>具体要求：</strong>
        <div style="margin-top: 8px; padding: 12px; background: #fff2f0; border: 1px solid #ffccc7; border-radius: 6px; white-space: pre-line;">
          ${e.rejectionReason}
        </div>
      </div>
      <div style="margin-top: 16px; padding: 12px; background: #e6f7ff; border-radius: 6px;">
        <div style="color: #1890ff; font-weight: 500;">💡 温馨提示</div>
        <div style="margin-top: 4px; color: #666;">请根据上述要求修改和补充材料后重新提交，如有疑问可联系审核人员。</div>
      </div>
    </div>
  `;je.info({title:"材料审核驳回详情",width:600,content:p,okText:"我知道了"})},ee=i=>{P.info(`提交整改材料：${i.projectName}`);let e="";i.conclusion&&i.conclusion.requirements&&(e=i.conclusion.requirements),I.push({path:"/approval/applicant/submit",query:{improvement:"true",projectId:i.id,projectName:encodeURIComponent(i.projectName),projectCode:i.projectCode,expectedTime:i.expectedTime,description:encodeURIComponent(i.description),improvementRequirements:encodeURIComponent(e)}})},te=()=>{R.value=!R.value},j=i=>{g.value.keyword="",g.value.status=i};return re(()=>{}),(i,e)=>{const p=m("a-button"),w=m("a-step"),b=m("a-tag"),S=m("a-steps"),z=m("a-card"),O=m("a-badge"),r=m("a-select-option"),ae=m("a-select"),se=m("a-input-search"),ie=m("a-progress"),le=m("a-space"),ne=m("a-table"),d=m("a-descriptions-item"),$=m("a-descriptions"),oe=m("a-modal");return v(),h("div",we,[s("div",xe,[e[11]||(e[11]=s("div",{class:"header-content"},[s("h1",{class:"page-title"},"立项申请管理"),s("p",{class:"page-description"},"查看和管理您提交的项目立项申请")],-1)),s("div",he,[t(p,{type:"primary",onClick:W},{default:a(()=>[t(f(me)),e[10]||(e[10]=l(" 提交新申请 ",-1))]),_:1,__:[10]})])]),s("div",Ie,[s("div",Re,[s("div",{class:"stat-card pending",onClick:e[0]||(e[0]=u=>j("material_reviewing"))},[s("div",Te,[t(f(_e))]),s("div",ze,[s("div",$e,o(k.value.materialReviewing),1),e[12]||(e[12]=s("div",{class:"stat-label"},"材料审核中",-1))])]),s("div",{class:"stat-card material-rejected",onClick:e[1]||(e[1]=u=>j("material_rejected"))},[s("div",Ne,[t(f(F))]),s("div",Se,[s("div",Oe,o(k.value.materialRejected),1),e[13]||(e[13]=s("div",{class:"stat-label"},"材料审核未通过",-1))])]),s("div",{class:"stat-card reviewing",onClick:e[2]||(e[2]=u=>j("meeting_preparing"))},[s("div",Pe,[t(f(D))]),s("div",qe,[s("div",Ue,o(k.value.meetingPreparing),1),e[14]||(e[14]=s("div",{class:"stat-label"},"会议待组织",-1))])]),s("div",{class:"stat-card scheduled",onClick:e[3]||(e[3]=u=>j("meeting_scheduled"))},[s("div",Me,[t(f(fe))]),s("div",Ve,[s("div",Fe,o(k.value.meetingScheduled),1),e[15]||(e[15]=s("div",{class:"stat-label"},"会议已安排",-1))])]),s("div",{class:"stat-card completed",onClick:e[4]||(e[4]=u=>j("approval_passed"))},[s("div",De,[t(f(ge))]),s("div",Je,[s("div",Ae,o(k.value.approvalPassed),1),e[16]||(e[16]=s("div",{class:"stat-label"},"立项通过",-1))])]),s("div",{class:"stat-card conditional",onClick:e[5]||(e[5]=u=>j("approval_conditional"))},[s("div",Be,[t(f(be))]),s("div",Ee,[s("div",Qe,o(k.value.approvalConditional),1),e[17]||(e[17]=s("div",{class:"stat-label"},"有条件通过",-1))])]),s("div",{class:"stat-card rejected",onClick:e[6]||(e[6]=u=>j("approval_failed"))},[s("div",We,[t(f(ye))]),s("div",Ge,[s("div",Ke,o(k.value.approvalFailed),1),e[18]||(e[18]=s("div",{class:"stat-label"},"立项未通过",-1))])])])]),t(z,{class:"flow-description",title:"立项流程说明",bordered:!1},{extra:a(()=>[t(p,{type:"link",size:"small",onClick:te},{default:a(()=>[l(o(R.value?"收起":"展开"),1)]),_:1})]),default:a(()=>[pe(s("div",Xe,[t(S,{current:3,size:"small",direction:"horizontal",status:"finish"},{default:a(()=>[t(w,{title:"提交申请",description:"准备材料并提交立项申请",status:"finish"}),t(w,{title:"材料审核",status:"finish"},{description:a(()=>[s("div",Ze,[e[20]||(e[20]=l(" 等待管理员审核立项材料 ",-1)),s("div",He,[t(b,{color:"orange",size:"small"},{default:a(()=>e[19]||(e[19]=[l("材料审核中",-1)])),_:1,__:[19]})])])]),_:1}),t(w,{title:"组织会议",status:"finish"},{description:a(()=>[s("div",Le,[e[23]||(e[23]=l(" 等待管理员组织立项会议 ",-1)),s("div",Ye,[t(b,{color:"blue",size:"small"},{default:a(()=>e[21]||(e[21]=[l("会议待组织",-1)])),_:1,__:[21]}),t(b,{color:"cyan",size:"small"},{default:a(()=>e[22]||(e[22]=[l("会议已安排",-1)])),_:1,__:[22]})])])]),_:1}),t(w,{title:"立项结论",status:"finish"},{description:a(()=>[s("div",et,[e[27]||(e[27]=l(" 根据会议结果获得最终结论 ",-1)),s("div",tt,[t(b,{color:"green",size:"small"},{default:a(()=>e[24]||(e[24]=[l("立项通过",-1)])),_:1,__:[24]}),t(b,{color:"orange",size:"small"},{default:a(()=>e[25]||(e[25]=[l("有条件通过",-1)])),_:1,__:[25]}),t(b,{color:"red",size:"small"},{default:a(()=>e[26]||(e[26]=[l("立项未通过",-1)])),_:1,__:[26]})])])]),_:1})]),_:1})],512),[[ue,R.value]])]),_:1}),t(z,{bordered:!1},{title:a(()=>[s("div",at,[e[28]||(e[28]=s("span",null,"我的立项申请",-1)),t(O,{count:k.value.total,"number-style":{backgroundColor:"#1890ff"}},null,8,["count"])])]),extra:a(()=>[s("div",st,[t(ae,{value:g.value.status,"onUpdate:value":e[7]||(e[7]=u=>g.value.status=u),placeholder:"筛选状态",style:{width:"150px"},onChange:G},{default:a(()=>[t(r,{value:""},{default:a(()=>e[29]||(e[29]=[l("全部状态",-1)])),_:1,__:[29]}),t(r,{value:"material_reviewing"},{default:a(()=>e[30]||(e[30]=[l("材料审核中",-1)])),_:1,__:[30]}),t(r,{value:"meeting_preparing"},{default:a(()=>e[31]||(e[31]=[l("会议待组织",-1)])),_:1,__:[31]}),t(r,{value:"meeting_scheduled"},{default:a(()=>e[32]||(e[32]=[l("会议已安排",-1)])),_:1,__:[32]}),t(r,{value:"approval_passed"},{default:a(()=>e[33]||(e[33]=[l("立项通过",-1)])),_:1,__:[33]}),t(r,{value:"approval_conditional"},{default:a(()=>e[34]||(e[34]=[l("有条件通过",-1)])),_:1,__:[34]}),t(r,{value:"approval_failed"},{default:a(()=>e[35]||(e[35]=[l("立项未通过",-1)])),_:1,__:[35]})]),_:1},8,["value"]),t(se,{value:g.value.keyword,"onUpdate:value":e[8]||(e[8]=u=>g.value.keyword=u),placeholder:"搜索项目名称",style:{width:"200px"},onSearch:K},null,8,["value"])])]),default:a(()=>[t(ne,{columns:J,"data-source":A.value,pagination:q.value,"row-key":"id",size:"middle"},{bodyCell:a(({column:u,record:c})=>[u.key==="status"?(v(),y(b,{key:0,color:U(c.status)},{default:a(()=>[l(o(M(c.status)),1)]),_:2},1032,["color"])):u.key==="progress"?(v(),h("div",it,[t(ie,{percent:B(c.status),size:"small",status:E(c.status)},null,8,["percent","status"]),s("div",lt,o(Q(c.status,c)),1)])):u.key==="actions"?(v(),y(le,{key:2},{default:a(()=>[c.status==="material_rejected"?(v(),y(p,{key:0,type:"primary",size:"small",onClick:N=>L(c)},{default:a(()=>e[36]||(e[36]=[l(" 重新提交材料 ",-1)])),_:2,__:[36]},1032,["onClick"])):_("",!0),c.status==="approval_conditional"?(v(),y(p,{key:1,type:"primary",size:"small",onClick:N=>ee(c)},{default:a(()=>e[37]||(e[37]=[l(" 提交整改材料 ",-1)])),_:2,__:[37]},1032,["onClick"])):_("",!0),c.status==="approval_failed"?(v(),y(p,{key:2,type:"primary",size:"small",onClick:N=>X(c)},{default:a(()=>e[38]||(e[38]=[l(" 重新提交申请 ",-1)])),_:2,__:[38]},1032,["onClick"])):_("",!0),c.status==="material_rejected"?(v(),y(p,{key:3,size:"small",onClick:N=>Y(c)},{default:a(()=>e[39]||(e[39]=[l(" 查看驳回原因 ",-1)])),_:2,__:[39]},1032,["onClick"])):_("",!0),["approval_passed","approval_conditional","approval_failed"].includes(c.status)?(v(),y(p,{key:4,size:"small",onClick:N=>Z(c)},{default:a(()=>e[40]||(e[40]=[l(" 查看详情 ",-1)])),_:2,__:[40]},1032,["onClick"])):_("",!0)]),_:2},1024)):_("",!0)]),_:1},8,["data-source","pagination"])]),_:1}),t(oe,{open:T.value,"onUpdate:open":e[9]||(e[9]=u=>T.value=u),title:"立项申请详情",width:"800px",footer:null,onCancel:H},{default:a(()=>[n.value?(v(),h("div",nt,[s("div",ot,[s("h4",null,[t(f(Ce)),e[41]||(e[41]=l(" 项目基本信息",-1))]),t($,{column:2,bordered:"",size:"small"},{default:a(()=>[t(d,{label:"年度"},{default:a(()=>[l(o(n.value.year),1)]),_:1}),t(d,{label:"项目编号"},{default:a(()=>[l(o(n.value.projectCode),1)]),_:1}),t(d,{label:"立项名称",span:2},{default:a(()=>[l(o(n.value.projectName),1)]),_:1}),t(d,{label:"申请人"},{default:a(()=>[l(o(n.value.applicant),1)]),_:1}),t(d,{label:"申请单位"},{default:a(()=>[l(o(n.value.department),1)]),_:1}),t(d,{label:"项目周期(月)"},{default:a(()=>[l(o(n.value.duration)+"个月 ",1)]),_:1}),t(d,{label:"预算(万元)"},{default:a(()=>[l(o(n.value.budget)+"万元 ",1)]),_:1}),t(d,{label:"申请时间"},{default:a(()=>[l(o(n.value.submitTime),1)]),_:1}),t(d,{label:"当前状态"},{default:a(()=>[t(b,{color:U(n.value.status)},{default:a(()=>[l(o(M(n.value.status)),1)]),_:1},8,["color"])]),_:1}),t(d,{label:"项目描述",span:2},{default:a(()=>[l(o(n.value.description),1)]),_:1})]),_:1})]),n.value.meetingInfo?(v(),h("div",dt,[s("h4",null,[t(f(D)),e[42]||(e[42]=l(" 会议信息",-1))]),t($,{column:2,bordered:"",size:"small"},{default:a(()=>[t(d,{label:"会议时间"},{default:a(()=>[l(o(n.value.meetingInfo.time),1)]),_:1}),t(d,{label:"会议地点"},{default:a(()=>[l(o(n.value.meetingInfo.location),1)]),_:1}),t(d,{label:"会议形式",span:2},{default:a(()=>[l(o(n.value.meetingInfo.type==="offline"?"现场会议":n.value.meetingInfo.type==="online"?"线上会议":"混合会议"),1)]),_:1}),n.value.meetingInfo.description?(v(),y(d,{key:0,label:"会议说明",span:2},{default:a(()=>[l(o(n.value.meetingInfo.description),1)]),_:1})):_("",!0)]),_:1})])):_("",!0),n.value.conclusion?(v(),h("div",rt,[s("h4",null,[t(f(ke)),e[43]||(e[43]=l(" 立项结论",-1))]),t($,{column:2,bordered:"",size:"small"},{default:a(()=>[t(d,{label:"立项结果"},{default:a(()=>[t(b,{color:n.value.conclusion.result==="passed"?"green":n.value.conclusion.result==="failed"?"red":"orange"},{default:a(()=>[l(o(n.value.conclusion.result==="passed"?"立项通过":n.value.conclusion.result==="failed"?"立项未通过":"有条件通过"),1)]),_:1},8,["color"])]),_:1}),t(d,{label:"结论时间"},{default:a(()=>[l(o(n.value.conclusion.time),1)]),_:1}),n.value.conclusion.score?(v(),y(d,{key:0,label:"评分"},{default:a(()=>[s("span",{style:ce({color:n.value.conclusion.score>=90?"#52c41a":n.value.conclusion.score>=80?"#fa8c16":"#ff4d4f"})},o(n.value.conclusion.score)+"分 ",5)]),_:1})):_("",!0),t(d,{label:"结论说明",span:2},{default:a(()=>[l(o(n.value.conclusion.description),1)]),_:1}),n.value.conclusion.requirements?(v(),y(d,{key:1,label:"整改要求",span:2},{default:a(()=>[s("div",pt,o(n.value.conclusion.requirements),1)]),_:1})):_("",!0)]),_:1})])):_("",!0),n.value.rejectionInfo?(v(),h("div",ut,[s("h4",null,[t(f(F)),e[44]||(e[44]=l(" 驳回信息",-1))]),t($,{column:2,bordered:"",size:"small"},{default:a(()=>[t(d,{label:"驳回时间"},{default:a(()=>[l(o(n.value.rejectionInfo.time),1)]),_:1}),t(d,{label:"审核人员"},{default:a(()=>[l(o(n.value.rejectionInfo.reviewer),1)]),_:1}),t(d,{label:"审核意见",span:2},{default:a(()=>[l(o(n.value.rejectionInfo.comments),1)]),_:1}),t(d,{label:"驳回原因",span:2},{default:a(()=>[s("div",ct,o(n.value.rejectionInfo.rejectionReason),1)]),_:1})]),_:1})])):_("",!0)])):_("",!0)]),_:1},8,["open"])])}}},bt=ve(vt,[["__scopeId","data-v-e004f228"]]);export{bt as default};
